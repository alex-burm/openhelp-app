<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Welcome!{% endblock %}</title>
    <link  href="{{ asset('css/variables.css') }}" rel="stylesheet">
    <link  href="{{ asset('css/styles.css') }}" rel="stylesheet">
</head>
<body>
    <div class="wrapper">
        <div class="main">
            <div id="app" style="width: 640px; height: 600px; display: flex;padding-top: 8px;"></div>
        </div>
    </div>

    <link  href="{{ asset('build/public-chat.css') }}" rel="stylesheet">
    <script src="{{ asset('build/public-chat.js') }}"></script>

    <script type="application/x-chat-header" id="public-chat-header">
        <div class="custom-header">
          <strong>Custom header</strong>
        </div>
    </script>

    <script>
        OpenHelpChat.init({
            customHeaderHtml: document.getElementById('public-chat-header').innerHTML,
            user: {
                name: 'Alex',
                email: 'user@example.com',
            },
            connection: {
                url: 'ws://localhost:8018/connection/websocket',
                channel: 'user#123',
                getToken: async () => {
                    const response = await fetch('{{ path('chat_token') }}', {
                        headers: {
                            'Content-Type': 'application/json'
                        },
                    });

                    const data = await response.json();
                    return data.token;
                }
            },
            chat: {
                history: [
                    {type: 'system', text: 'Request #00000-0000-0000-00000'},
                    {type: 'message', text: 'Привет!', time: '12:00', subtype: 'incoming'},
                    {type: 'message', text: 'Здравствуйте 1!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 2!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 3!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 4!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 5!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 6!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 7!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 8!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 9!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 10!', time: '12:01', subtype: 'outgoing'},
                    {type: 'system', text: 'The request was resolved!'},
                    {type: 'message', text: 'Здравствуйте 11!', time: '12:01', subtype: 'outgoing'},
                    {type: 'message', text: 'Здравствуйте 12!', time: '12:01', subtype: 'outgoing'},
                ]
            }
        });

        {#import { initChatApp } from '{{ asset('build/public-chat.js') }}'#}

//         initChatApp({
//             user: { name: 'Admin' },
//             chatRoomId: 'room:admin',
//             centrifugo: { url: 'wss://...' }
//         })
    </script>
</body>
</html>
